---
title: "Building a Continuous AI Workflow with PostHog MCP and GitHub CLI"
description: "Build an automated system that continuously monitors PostHog analytics, analyzes user behavior with AI, and creates GitHub issues automatically using PostHog MCP."
sidebarTitle: "PostHog Analytics with Continue CLI"
---

<Card title="What You'll Build" icon="robot">
  A fully automated workflow that uses Continue CLI with PostHog MCP to fetch
  analytics data, analyze user experience issues with AI, and automatically create GitHub
  issues with specific technical recommendations using GitHub CLI
</Card>

## What You'll Learn

This cookbook teaches you to:
- Use PostHog MCP to query analytics, errors, and feature flags
- Analyze user behavior patterns with AI
- Automatically create GitHub issues using GitHub CLI
- Set up continuous monitoring with GitHub Actions

## Prerequisites

- GitHub repository where you want to create issues
- [PostHog account](https://posthog.com) with data collecting
- Node.js 18+ installed locally
- [Continue CLI](https://docs.continue.dev/guides/cli) with **active credits** (required for API usage)
- [GitHub CLI](https://cli.github.com/) installed (`gh` command)

## Quick Setup

<Steps>
  <Step title="Install Continue CLI">
    ```bash
    npm i -g @continuedev/cli
    ```
  </Step>
  
  <Step title="Install PostHog MCP">
    Configure PostHog MCP for natural language analytics:
    
    1. Visit [PostHog MCP on Continue Hub](https://hub.continue.dev/posthog/posthog-mcp)
    2. Click **"Install"** and follow the configuration for your editor
    3. Or run: `npx @posthog/wizard@latest mcp add`
    4. See [PostHog MCP docs](https://posthog.com/docs/model-context-protocol) for details
  </Step>

  <Step title="Set Up Continue CLI & GitHub CLI">
    1. Visit [Continue Organizations](https://hub.continue.dev/settings/organizations)
    2. Create an API key and login: `cn login`
    3. Install GitHub CLI: `brew install gh` (macOS) or [see docs](https://cli.github.com/)
    4. Authenticate GitHub: `gh auth login`
  </Step>

  <Step title="Verify Setup">
    Test PostHog MCP connection:
    ```bash
    cn
    # Then in TUI mode:
    "Using PostHog MCP, show my active feature flags and recent errors"
    ```
  </Step>
</Steps>

<Tip>
  PostHog MCP handles all authentication through the Continue Hub - no need to
  manually configure API keys! GitHub CLI manages GitHub authentication separately.
</Tip>

## Step 1: Set Up Your Credentials

First, you'll need to gather your API credentials and add them as secrets in Continue CLI.

### Get Your PostHog API Credentials

You need a **Personal API Key** (not a Project API key) to access session recordings:

1. Go to [Personal API Keys](https://app.posthog.com/settings/user-api-keys) in PostHog
2. Click **+ Create a personal API Key**
3. Name it "Continue CLI Session Analysis"
4. Select these scopes:
   - `session_recording:read` - **Required** for accessing session data
   - `insight:read` - Optional, for additional analytics
5. Copy the key immediately (you won't see it again!)
6. Add the key to Continue secrets as `POSTHOG_AUTH_HEADER`:
   - Format: `Bearer YOUR_API_KEY_HERE`
   - See [Continue Secrets Documentation](https://docs.continue.dev/hub/secrets/secret-types#secret-types) for how to add secrets

<Info>
  **Continue Secrets**: The `POSTHOG_AUTH_HEADER` secret should be stored in Continue's secure secrets storage. This keeps your API key safe and the MCP automatically connects to your default PostHog project.
</Info>

### Set Up GitHub CLI Authentication

GitHub CLI handles authentication automatically - no manual PAT needed:

1. Install GitHub CLI if not already installed
2. Run `gh auth login` and follow the prompts
3. Choose authentication method (browser or token)
4. Grant necessary permissions when prompted

### Configure API Access

You only need to configure the PostHog MCP credential - it automatically handles project selection:

```bash
# Add your PostHog API key as a Continue secret:
1. Get your Personal API Key from PostHog (phx_...)
2. Add it as POSTHOG_AUTH_HEADER secret with format: Bearer YOUR_API_KEY
3. See https://docs.continue.dev/hub/secrets/secret-types#secret-types for adding secrets

# GitHub authentication is handled separately via:
gh auth login
```

<Info>
  **How PostHog MCP Works**:
  - Your API key is tied to your PostHog account and organization
  - It automatically uses your default project (no project ID needed)
  - If you have multiple projects, use `mcp__posthog__switch-project` to change
  - The MCP connects via `https://mcp.posthog.com/sse` using your account context
</Info>

<Tip>
  **No GitHub PAT Needed**: The `gh` CLI handles GitHub authentication separately.
  Just run `gh auth login` once and it manages tokens automatically.
</Tip>

## Performance Analysis Steps

### Step 1: Analyze PostHog Sessions

Fetch and analyze session recordings for UX issues:

```bash
# Start cn in TUI mode
cn

# Then ask:
"Analyze PostHog session recordings for UX issues:
- Fetch last 20 sessions from PostHog API
- Filter for: console errors OR duration > 5 minutes
- Identify top 3 UX problems with:
  - Problem description
  - Technical root cause
  - Affected pages/URLs
  - Specific fixes
  - Priority (HIGH/MEDIUM/LOW)
  - Impact percentage
Format as GitHub issues ready for creation."
```

<Card title="Automatic Analysis" icon="wand-magic-sparkles">
  Continue CLI will:
  - Fetch session data from PostHog API
  - Apply intelligent filtering for problematic sessions
  - Generate actionable GitHub issues
  - Quantify impact based on real data
</Card>

### Step 2: Create GitHub Issues

Use GitHub CLI to create issues from your analysis:

```bash
# In cn TUI mode:
"Create GitHub issues from the PostHog analysis using gh CLI:
- For each issue, run: gh issue create --title 'üîç UX Issue: [title]' --body '[details]'
- Add labels: --label 'bug,user-experience,automated'
- Set priority labels (high/medium/low)
- Include session data and technical details in the body
Execute the commands and confirm each issue was created with URL."
```

<Info>
  **Why GitHub CLI over GitHub MCP**: While GitHub MCP is available, it can be 
  token-expensive to run. The `gh` CLI is more efficient, requires no API tokens 
  (authenticated via `gh auth login`), and provides a cleaner command-line experience.
  GitHub MCP remains an option if you prefer full MCP integration.
</Info>

<Warning>
  **Repository Labels**: Ensure your repo has labels for bug, enhancement,
  priority levels, and automated tracking. The GitHub MCP tool can help create
  these automatically.
</Warning>

## Continuous Monitoring

### Step 3: Automated GitHub Actions Workflow

Create a GitHub Actions workflow that runs your Continue CLI analysis automatically on a schedule.

### Add GitHub Secrets

First, add these secrets to your GitHub repository:

1. Go to **Repository Settings ‚Üí Secrets and variables ‚Üí Actions**
2. Click **"New repository secret"** and add:
   - `CONTINUE_API_KEY`: Your Continue API key from hub.continue.dev
   - `POSTHOG_API_KEY`: Your PostHog Personal API Key
   - `POSTHOG_PROJECT_ID`: Your PostHog Project ID
   - `POSTHOG_HOST`: `https://us.posthog.com` (or your custom PostHog host)
   - `GITHUB_PAT`: Your GitHub Personal Access Token

### GitHub Actions Configuration

Create `.github/workflows/posthog-analysis.yml`:

```yaml
name: PostHog Session Analysis with Continue CLI

on:
  schedule:
    - cron: "0 6 * * *" # Run at 6 AM UTC daily
  workflow_dispatch: # Allow manual triggering

jobs:
  analyze:
    runs-on: ubuntu-latest

    permissions:
      contents: read
      issues: write

    steps:
      - uses: actions/checkout@v4

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "18"

      - name: Install Continue CLI
        run: |
          npm install -g @continuedev/cli
          echo "‚úÖ Continue CLI installed"
          cn --version

      - name: Set up environment variables
        run: |
          echo "POSTHOG_API_KEY=${{ secrets.POSTHOG_API_KEY }}" >> $GITHUB_ENV
          echo "POSTHOG_PROJECT_ID=${{ secrets.POSTHOG_PROJECT_ID }}" >> $GITHUB_ENV
          echo "POSTHOG_HOST=${{ secrets.POSTHOG_HOST || 'https://us.posthog.com' }}" >> $GITHUB_ENV
          echo "GITHUB_PAT=${{ secrets.GITHUB_PAT }}" >> $GITHUB_ENV
          echo "GITHUB_OWNER=${{ github.repository_owner }}" >> $GITHUB_ENV
          echo "GITHUB_REPO=$(echo ${{ github.repository }} | cut -d'/' -f2)" >> $GITHUB_ENV

      - name: Authenticate with Continue CLI
        run: |
          # Set Continue API key
          export CONTINUE_API_KEY="${{ secrets.CONTINUE_API_KEY }}"
          # Login to Continue CLI
          if ! cn auth login --api-key "$CONTINUE_API_KEY"; then
            echo "‚ùå Failed to authenticate with Continue CLI"
            exit 1
          fi
          echo "‚úÖ Continue CLI authenticated"

      - name: Run PostHog Session Analysis
        run: |
          echo "üé¨ Starting PostHog session analysis..."
          
          npx @continuedev/cli@latest << 'EOF'
          Analyze PostHog sessions and create GitHub issues:
          1. Fetch last 20 sessions from PostHog API
          2. Filter for errors or long sessions (>5 min)
          3. Identify top 3 UX problems
          4. Create GitHub issues with labels and priority using gh CLI
          5. Execute: gh issue create --title '[Title]' --body '[Details]' --label 'automated'
          
          PostHog credentials from environment:
          - API Key: $POSTHOG_API_KEY
          - Project: $POSTHOG_PROJECT_ID
          - Host: $POSTHOG_HOST
          
          Output summary of created issues.
          EOF > results.txt
          
          echo "‚úÖ Analysis completed"
          cat results.txt

      # Issues are created in the previous step with MCP tools

      - name: Upload Analysis Artifacts
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: analysis-results-${{ github.run_number }}
          path: results.txt
          retention-days: 30

      - name: Summary
        run: |
          echo "‚úÖ PostHog analysis workflow completed!"
          echo "üìä Check the artifacts for detailed analysis results"
          echo "üêõ Check your repository issues for newly created UX issues"
```

## Testing Your Setup

### Local Testing

Test the complete workflow locally:

```bash
# In cn TUI mode:
"Test PostHog to GitHub workflow:
1. Fetch 5 recent PostHog sessions
2. Analyze for UX issues
3. Create 1 test GitHub issue with 'test' label
4. Confirm issue creation and provide URL"
```

### Production Testing Checklist

<Check>
  **Success Indicators:**
  - PostHog API connection verified
  - Session data fetched successfully
  - AI analysis identifies real UX issues
  - GitHub issues created with proper labels
  - GitHub Actions workflow runs on schedule
</Check>

## Troubleshooting

### Debug Connection Issues

```bash
# In cn TUI mode:
"Debug PostHog and GitHub connections:
1. Test PostHog API with my credentials
2. Verify gh CLI is authenticated: gh auth status
3. Check for missing environment variables
4. Suggest fixes for any errors found"
```

### Common Issues

| Issue | Quick Fix |
|-------|----------|
| PostHog API fails | Check API key scopes include session_recording:read |
| GitHub issues not created | Run `gh auth login` to authenticate GitHub CLI |
| No session data | Ensure PostHog has session recordings enabled |
| Rate limits | Reduce session fetch limit or add delays |

## What You've Accomplished

<Card title="Automated UX Analysis Pipeline" icon="chart-line">
  You've built an AI-powered system that:
  - Continuously monitors PostHog session recordings
  - Identifies UX problems automatically
  - Creates actionable GitHub issues
  - Runs daily via GitHub Actions
  - Leverages MCP tools for seamless integration
</Card>

‚úÖ **Level 2 Continuous AI** - AI analyzes data and creates tasks with human review  
‚úÖ **MCP Integration** - Natural language commands replace manual API calls  
‚úÖ **Scalable Workflow** - Handles growing session data automatically

## Best Practices

<Warning>
  **Security First:**
  - Store credentials as GitHub Secrets only
  - Use MCP tools for authentication when possible
  - Limit API scopes to minimum required
  - Rotate keys every 90 days
  - Monitor API usage for anomalies
</Warning>

## Advanced Strategies

### Performance Correlation
```bash
# In cn TUI mode:
"Correlate PostHog performance metrics with session errors"
```

### Feature Flag Impact
```bash
"Analyze how feature flags affect user behavior in sessions"
```

### Slack Integration
```bash
"Send critical UX issues to Slack channel #ux-alerts"
```

## Next Steps

- Consider [GitHub MCP](https://hub.continue.dev/github/github-mcp) as an alternative (note: can be token-expensive)
- Configure [Slack MCP](https://hub.continue.dev/slack/slack-mcp) for alerts
- Set up [performance monitoring](https://posthog.com/docs/web-analytics)
- Join the [Continue Discord](https://discord.gg/continue) for support

## Resources

- [PostHog API Documentation](https://posthog.com/docs/api)
- [GitHub CLI Documentation](https://cli.github.com/)
- [GitHub MCP on Continue Hub](https://hub.continue.dev/github/github-mcp) (alternative option)
- [Continue CLI Guide](https://docs.continue.dev/guides/cli)
- [Continuous AI Best Practices](https://blog.continue.dev/what-is-continuous-ai-a-developers-guide/)
